<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Kerama Islands Guide</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/manifest+json,%7B%22name%22%3A%22Kerama%20Islands%20Guide%22%2C%22short_name%22%3A%22KeramaGuide%22%2C%22description%22%3A%22Tourism%20guide%20for%20Okinawa%27s%20Kerama%20Islands%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23006D8F%22%2C%22theme_color%22%3A%22%23006D8F%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%20100%20100%27%3E%3Crect%20width%3D%27100%27%20height%3D%27100%27%20fill%3D%27%23006D8F%27%2F%3E%3Ccircle%20cx%3D%2750%27%20cy%3D%2730%27%20r%3D%2715%27%20fill%3D%27white%27%2F%3E%3Cpath%20d%3D%27M50%2045%20L45%2065%20L55%2065%20Z%27%20fill%3D%27white%27%2F%3E%3Cpath%20d%3D%27M50%2050%20L35%2030%20L40%2025%20L50%2040%20L60%2025%20L65%2030%20Z%27%20fill%3D%27white%27%2F%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%22100x100%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%2C%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%20192%20192%27%3E%3Crect%20width%3D%27192%27%20height%3D%27192%27%20fill%3D%27%23006D8F%27%2F%3E%3Ccircle%20cx%3D%2796%27%20cy%3D%2758%27%20r%3D%2729%27%20fill%3D%27white%27%2F%3E%3Cpath%20d%3D%27M96%2086%20L86%20125%20L106%20125%20Z%27%20fill%3D%27white%27%2F%3E%3Cpath%20d%3D%27M96%2096%20L74%2058%20L77%2048%20L96%2077%20L115%2048%20L118%2058%20Z%27%20fill%3D%27white%27%2F%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%2C%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20viewBox%3D%270%200%20512%20512%27%3E%3Crect%20width%3D%27512%27%20height%3D%27512%27%20fill%3D%27%23006D8F%27%2F%3E%3Ccircle%20cx%3D%27256%27%20cy%3D%27154%27%20r%3D%2777%27%20fill%3D%27white%27%2F%3E%3Cpath%20d%3D%27M256%20231%20L231%20321%20L281%20321%20Z%27%20fill%3D%27white%27%2F%3E%3Cpath%20d%3D%27M256%20256%20L197%20154%20L205%20128%20L256%20205%20L307%20128%20L315%20154%20Z%27%20fill%3D%27white%27%2F%3E%3C%2Fsvg%3E%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%7D%5D%7D">
    
    <!-- Favicon and PWA icons -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23006D8F'/><circle cx='50' cy='30' r='15' fill='white'/><path d='M50 45 L45 65 L55 65 Z' fill='white'/><path d='M50 50 L35 30 L40 25 L50 40 L60 25 L65 30 Z' fill='white'/></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23006D8F'/><circle cx='50' cy='30' r='15' fill='white'/><path d='M50 45 L45 65 L55 65 Z' fill='white'/><path d='M50 50 L35 30 L40 25 L50 40 L60 25 L65 30 Z' fill='white'/></svg>">
    
    <style>
        /* ã‚¹ã‚¿ã‚¤ãƒ«ã¯å‰å›ã¨åŒã˜ */
        :root {
            --primary: #006D8F;
            --secondary: #003D4D;
            --text: #f0f0f0;
            --bg: #121212;
            --card-bg: #1e1e1e;
            --light-text: #333;
            --light-bg: #f5f5f5;
            --light-card-bg: #ffffff;
        }
        
        [data-theme="light"] {
            --primary: #006D8F;
            --secondary: #0093B8;
            --text: #333;
            --bg: #f5f5f5;
            --card-bg: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 60px;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        button {
            background-color: var(--secondary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        button:hover {
            opacity: 0.9;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        h2 {
            color: var(--primary);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
        }
        
        h3 {
            margin: 1rem 0 0.5rem;
            color: var(--secondary);
        }
        
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
            display: block;
        }
        
        .ferry-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        .ferry-table th, .ferry-table td {
            border: 1px solid var(--secondary);
            padding: 0.5rem;
            text-align: left;
        }
        
        .ferry-table th {
            background-color: var(--secondary);
            color: white;
        }
        
        .island-section {
            margin-bottom: 2rem;
        }
        
        .beach-list, .facility-list {
            list-style-type: none;
            padding-left: 1rem;
        }
        
        .beach-list li, .facility-list li {
            margin-bottom: 0.5rem;
            position: relative;
            padding-left: 1.5rem;
        }
        
        .beach-list li::before {
            content: "ğŸ–ï¸";
            position: absolute;
            left: 0;
        }
        
        .facility-list li::before {
            content: "ğŸ“";
            position: absolute;
            left: 0;
        }
        
        footer {
            background-color: var(--primary);
            color: white;
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
        }
        
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            z-index: 100;
            display: none;
        }
        
        .back-to-top:hover {
            background-color: var(--secondary);
        }
        
        .update-date {
            font-style: italic;
            color: var(--secondary);
            margin-bottom: 1rem;
        }
        
        .hidden {
            display: none;
        }
        
        .map-container {
            position: relative;
            margin: 1rem 0;
        }
        
        .map-label {
            position: absolute;
            background-color: rgba(0, 109, 143, 0.8);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .transport-option {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: rgba(0, 109, 143, 0.1);
            border-radius: 8px;
        }
        
        .transport-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            color: var(--primary);
        }
        
        .transport-info {
            flex: 1;
        }
        
        .to-top-container {
            text-align: center;
            margin: 2rem 0;
        }
        
        .to-top-button {
            background-color: var(--primary);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
            font-weight: bold;
        }
        
        .to-top-button:hover {
            background-color: var(--secondary);
        }
        
        /* Install button styles */
        #install-container {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 100;
        }
        
        #install-button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            font-size: 0.9rem;
        }
        
        #install-button:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
        }
        
        #install-button i {
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <header>
        <h1 lang="en">Okinawa Kerama Islands Tourism Guide</h1>
        <h1 lang="ja" class="hidden">æ…¶è‰¯é–“è«¸å³¶è¦³å…‰ã‚¬ã‚¤ãƒ‰</h1>
        <div class="controls">
            <button id="theme-toggle"><i class="fas fa-moon"></i> <span lang="en">Dark Mode</span><span lang="ja" class="hidden">ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰</span></button>
            <button id="lang-toggle"><i class="fas fa-language"></i> <span lang="en">æ—¥æœ¬èª</span><span lang="ja" class="hidden">English</span></button>
        </div>
    </header>
    
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT4E5n8zGzQTe9ldQcy6GUvZ93UW6rhL2X3W_K-_Bpb8OSN9MJ6NiRNH68&s=10">

    <div class="container">
        <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„éƒ¨åˆ†ã¯å‰å›ã¨åŒã˜ -->
        <section class="card">
            <h2 lang="en">Kerama Islands Map</h2>
            <h2 lang="ja" class="hidden">æ…¶è‰¯é–“è«¸å³¶ãƒãƒƒãƒ—</h2>
            <div class="map-container">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR31CQlY31kHgPkFH8qvLpjIuLvW32ax0mOpVEMwSs0xPMVfchpoQ5QUTUj&s=10" alt="Map of Kerama Islands">
                <div class="map-label" style="top: 20%; left: 20%;"></div>
                <div class="map-label" style="top: 50%; left: 20%;"></div>
                <div class="map-label" style="top: 60%; left: 80%;"></div>
            </div>
            <p lang="en">The Kerama Islands are a group of 22 islands located about 40 kilometers west of Okinawa Main Island. The three main islands for tourism are Zamami, Aka, and Tokashiki.</p>
            <p lang="ja" class="hidden">æ…¶è‰¯é–“è«¸å³¶ã¯æ²–ç¸„æœ¬å³¶ã®è¥¿ç´„40kmã«ä½ç½®ã™ã‚‹22ã®å³¶ã€…ã‹ã‚‰ãªã‚‹ç¾¤å³¶ã§ã™ã€‚è¦³å…‰ã®ä¸»è¦ãªå³¶ã¯åº§é–“å‘³å³¶ã€é˜¿å˜‰å³¶ã€æ¸¡å˜‰æ•·å³¶ã®3ã¤ã§ã™ã€‚</p>
        </section>
        
        <!-- ä»–ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚‚åŒæ§˜ã«ä¿æŒ -->
        
    </div>
    
    <footer>
        <p lang="en">Contact me: <a href="mailto:mementomorikatsu@gmail.com" style="color: white;">mementomorikatsu@gmail.com</a></p>
        <p lang="ja" class="hidden">é€£çµ¡å…ˆ: <a href="mailto:mementomorikatsu@gmail.com" style="color: white;">mementomorikatsu@gmail.com</a></p>
    </footer>
    
    <div class="back-to-top" id="back-to-top">
        <i class="fas fa-arrow-up"></i>
    </div>
    
    <!-- Install button container -->
    <div id="install-container">
        <button id="install-button" class="hidden">
            <i class="fas fa-download"></i>
            <span lang="en">Install App</span>
            <span lang="ja" class="hidden">ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span>
        </button>
    </div>
    
    <script>
        // æ—¥ä»˜è¨­å®š
        const today = new Date();
        document.getElementById('current-date').textContent = today.toLocaleDateString('en-US', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });
        document.getElementById('current-date-ja').textContent = today.toLocaleDateString('ja-JP', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric' 
        });
        
        // ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            
            if (newTheme === 'dark') {
                themeToggle.querySelector('span[lang="en"]').textContent = 'Dark Mode';
                themeToggle.querySelector('span[lang="ja"]').textContent = 'ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰';
            } else {
                themeToggle.querySelector('span[lang="en"]').textContent = 'Light Mode';
                themeToggle.querySelector('span[lang="ja"]').textContent = 'ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰';
            }
        });
        
        // è¨€èªåˆ‡ã‚Šæ›¿ãˆ
        const langToggle = document.getElementById('lang-toggle');
        langToggle.addEventListener('click', () => {
            const currentLang = document.documentElement.getAttribute('lang');
            const newLang = currentLang === 'en' ? 'ja' : 'en';
            document.documentElement.setAttribute('lang', newLang);
            
            document.querySelectorAll('[lang="en"]').forEach(el => {
                el.classList.toggle('hidden', newLang !== 'en');
            });
            document.querySelectorAll('[lang="ja"]').forEach(el => {
                el.classList.toggle('hidden', newLang !== 'ja');
            });
            
            if (newLang === 'en') {
                langToggle.querySelector('span[lang="en"]').textContent = 'æ—¥æœ¬èª';
                langToggle.querySelector('span[lang="ja"]').textContent = 'English';
            } else {
                langToggle.querySelector('span[lang="en"]').textContent = 'Japanese';
                langToggle.querySelector('span[lang="ja"]').textContent = 'è‹±èª';
            }
            
            updateInstallButtonText();
        });
        
        // ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹ãƒœã‚¿ãƒ³
        const backToTop = document.getElementById('back-to-top');
        const mainToTop = document.getElementById('main-to-top');
        
        window.addEventListener('scroll', () => {
            backToTop.style.display = window.pageYOffset > 300 ? 'flex' : 'none';
        });
        
        backToTop.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        mainToTop.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ©Ÿèƒ½
        let deferredPrompt;
        const installButton = document.getElementById('install-button');
        
        // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
        function updateInstallButtonText() {
            const currentLang = document.documentElement.getAttribute('lang');
            const enText = installButton.querySelector('span[lang="en"]');
            const jaText = installButton.querySelector('span[lang="ja"]');
            
            if (currentLang === 'ja') {
                enText.classList.add('hidden');
                jaText.classList.remove('hidden');
            } else {
                enText.classList.remove('hidden');
                jaText.classList.add('hidden');
            }
        }
        
        // beforeinstallpromptã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('beforeinstallprompt event triggered');
            e.preventDefault();
            deferredPrompt = e;
            
            // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
            installButton.classList.remove('hidden');
            updateInstallButtonText();
            
            // 5ç§’å¾Œã«è‡ªå‹•ã§éè¡¨ç¤ºã«ã™ã‚‹
            setTimeout(() => {
                if (installButton && !installButton.classList.contains('hidden')) {
                    installButton.classList.add('hidden');
                }
            }, 5000);
        });
        
        // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯å‡¦ç†
        installButton.addEventListener('click', async () => {
            if (!deferredPrompt) {
                console.log('No deferred prompt available');
                return;
            }
            
            console.log('Showing install prompt');
            deferredPrompt.prompt();
            
            const { outcome } = await deferredPrompt.userChoice;
            console.log(`User response: ${outcome}`);
            
            deferredPrompt = null;
            installButton.classList.add('hidden');
        });
        
        // ã‚¢ãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®å‡¦ç†
        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
            installButton.classList.add('hidden');
            deferredPrompt = null;
        });
        
        // Service Workerç™»éŒ²
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // ã‚·ãƒ³ãƒ—ãƒ«ãªService Workerã‚³ãƒ¼ãƒ‰
                const swCode = `
                    self.addEventListener('install', (event) => {
                        console.log('Service Worker installing');
                        event.waitUntil(self.skipWaiting());
                    });
                    
                    self.addEventListener('activate', (event) => {
                        console.log('Service Worker activating');
                        event.waitUntil(self.clients.claim());
                    });
                    
                    self.addEventListener('fetch', (event) => {
                        console.log('Fetching:', event.request.url);
                        event.respondWith(
                            fetch(event.request).catch(() => {
                                return new Response('You are offline. Please check your internet connection.', {
                                    headers: { 'Content-Type': 'text/plain' }
                                });
                            })
                        );
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl, { scope: './' })
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope:', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
        
        // PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯
        function checkPWAInstallable() {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('Already installed as PWA');
                installButton.classList.add('hidden');
                return;
            }
            
            // iOSã§ã¯beforeinstallpromptãŒç™ºç«ã—ãªã„ã®ã§ç‰¹åˆ¥å‡¦ç†
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                         (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
            
            if (isIOS) {
                console.log('iOS device detected - showing custom install instructions');
                installButton.classList.remove('hidden');
                updateInstallButtonText();
                
                installButton.addEventListener('click', () => {
                    alert(document.documentElement.getAttribute('lang') === 'ja' ? 
                        'Safariã§ã€Œå…±æœ‰ã€â†’ã€Œãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã€ã‚’é¸æŠã—ã¦ãã ã•ã„' : 
                        'In Safari, tap "Share" then "Add to Home Screen"');
                });
            }
        }
        
        // åˆæœŸåŒ–æ™‚ã«ãƒã‚§ãƒƒã‚¯
        checkPWAInstallable();
    </script>
</body>
</html>